Based on ThunderHack's render sysytem
